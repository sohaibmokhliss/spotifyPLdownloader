<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Playlist Downloader</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéµ Spotify Playlist Downloader</h1>
            <p>Download your favorite Spotify playlists locally</p>
            <div class="user-info" id="userInfo" style="margin-top: 15px; text-align: center;">
                <span id="username" style="color: #667eea; font-weight: 600;"></span>
                <button onclick="handleLogout()" style="margin-left: 15px; padding: 8px 20px; background: #e74c3c; color: white; border: none; border-radius: 5px; cursor: pointer;">Logout</button>
                <a href="/admin" id="adminLink" style="margin-left: 15px; padding: 8px 20px; background: #ff9800; color: white; text-decoration: none; border-radius: 5px; display: none;">Admin Dashboard</a>
            </div>
        </header>

        <div class="input-section">
            <div class="download-location-toggle">
                <label>Download Location:</label>
                <div class="toggle-buttons">
                    <button type="button" class="toggle-btn active" id="serverToggle" onclick="setDownloadLocation('server')">
                        üíæ Save to Server
                    </button>
                    <button type="button" class="toggle-btn" id="deviceToggle" onclick="setDownloadLocation('device')">
                        üì± Download to Device
                    </button>
                </div>
            </div>

            <div class="format-selector">
                <label>Format:</label>
                <div class="format-options">
                    <label class="format-option">
                        <input type="radio" name="playlistFormat" value="mp3" checked>
                        <span>üéµ MP3 (Audio Only)</span>
                    </label>
                    <label class="format-option">
                        <input type="radio" name="playlistFormat" value="mp4">
                        <span>üé¨ MP4 (Video)</span>
                    </label>
                </div>
            </div>

            <div class="input-group">
                <input
                    type="text"
                    id="playlistUrl"
                    placeholder="Paste Spotify playlist URL here..."
                    autocomplete="off"
                >
                <button id="fetchBtn" onclick="fetchPlaylist()">Fetch Playlist</button>
            </div>
            <p class="hint">Example: https://open.spotify.com/playlist/37i9dQZF1DXcBWIGoYBM5M</p>
        </div>

        <div class="divider">
            <span>OR</span>
        </div>

        <div class="input-section">
            <h3>üé¨ Direct YouTube Download</h3>

            <div class="format-selector">
                <label>Format:</label>
                <div class="format-options">
                    <label class="format-option">
                        <input type="radio" name="downloadFormat" value="mp3" checked>
                        <span>üéµ MP3 (Audio Only)</span>
                    </label>
                    <label class="format-option">
                        <input type="radio" name="downloadFormat" value="mp4">
                        <span>üé¨ MP4 (Video)</span>
                    </label>
                </div>
            </div>

            <div class="input-group">
                <input
                    type="text"
                    id="youtubeUrl"
                    placeholder="Paste YouTube video URL here..."
                    autocomplete="off"
                >
                <button id="youtubeDownloadBtn" onclick="downloadYouTube()">Download</button>
            </div>
            <p class="hint">Example: https://www.youtube.com/watch?v=dQw4w9WgXcQ</p>
            <div id="youtubeStatus" class="youtube-status" style="display: none;"></div>
        </div>

        <div class="divider">
            <span>OR</span>
        </div>

        <div class="input-section">
            <h3>üì∫ YouTube Playlist Download</h3>

            <div class="format-selector">
                <label>Format:</label>
                <div class="format-options">
                    <label class="format-option">
                        <input type="radio" name="youtubePlaylistFormat" value="mp3" checked>
                        <span>üéµ MP3 (Audio Only)</span>
                    </label>
                    <label class="format-option">
                        <input type="radio" name="youtubePlaylistFormat" value="mp4">
                        <span>üé¨ MP4 (Video)</span>
                    </label>
                </div>
            </div>

            <div class="input-group">
                <input
                    type="text"
                    id="youtubePlaylistUrl"
                    placeholder="Paste YouTube playlist URL here..."
                    autocomplete="off"
                >
                <button id="fetchYoutubePlaylistBtn" onclick="fetchYoutubePlaylist()">Fetch Playlist</button>
            </div>
            <p class="hint">Example: https://www.youtube.com/playlist?list=PLx0sYbCqOb8TBPRdmBHs5Iftvv9TPboYG</p>
        </div>

        <div id="youtubePlaylistInfo" class="playlist-info" style="display: none;">
            <div class="playlist-header">
                <img id="youtubePlaylistImage" src="" alt="Playlist thumbnail">
                <div class="playlist-details">
                    <h2 id="youtubePlaylistName"></h2>
                    <p id="youtubePlaylistDescription"></p>
                    <p class="track-count" id="youtubeVideoCount"></p>
                </div>
            </div>

            <div class="action-buttons">
                <button id="downloadYoutubePlaylistBtn" onclick="downloadYoutubePlaylist()" class="download-btn">
                    üì• Download All
                </button>
                <button id="stopYoutubePlaylistBtn" onclick="stopDownload()" class="stop-btn" style="display: none;">
                    ‚è∏Ô∏è Stop Download
                </button>
                <button id="resumeYoutubePlaylistBtn" onclick="resumeYoutubePlaylist()" class="resume-btn" style="display: none;">
                    ‚ñ∂Ô∏è Resume Download
                </button>
            </div>

            <div id="youtubeVideoList" class="track-list"></div>
        </div>

        <div id="playlistInfo" class="playlist-info" style="display: none;">
            <div class="playlist-header">
                <img id="playlistImage" src="" alt="Playlist cover">
                <div class="playlist-details">
                    <h2 id="playlistName"></h2>
                    <p id="playlistDescription"></p>
                    <p class="track-count" id="trackCount"></p>
                </div>
            </div>

            <div class="action-buttons">
                <button id="downloadBtn" onclick="downloadPlaylist()" class="download-btn">
                    üì• Download All
                </button>
                <button id="stopBtn" onclick="stopDownload()" class="stop-btn" style="display: none;">
                    ‚è∏Ô∏è Stop Download
                </button>
                <button id="resumeBtn" onclick="resumeDownload()" class="resume-btn" style="display: none;">
                    ‚ñ∂Ô∏è Resume Download
                </button>
            </div>

            <div id="trackList" class="track-list"></div>
        </div>

        <div id="progressSection" class="progress-section" style="display: none;">
            <h3>Download Progress</h3>
            
            <div class="progress-bar-container">
                <div id="progressBar" class="progress-bar"></div>
            </div>
            
            <p id="progressText" class="progress-text"></p>
            <p id="currentTrack" class="current-track"></p>

            <div class="results">
                <div class="completed">
                    <h4>‚úÖ Completed (<span id="completedCount">0</span>)</h4>
                    <ul id="completedList"></ul>
                </div>
                
                <div class="failed">
                    <h4>‚ùå Failed (<span id="failedCount">0</span>)</h4>
                    <ul id="failedList"></ul>
                </div>
            </div>
        </div>

        <div id="errorMessage" class="error-message" style="display: none;"></div>

        <div class="divider">

        <div class="input-section">
            <div id="allSongsStatus" class="youtube-status" style="display: none;"></div>
        </div>

        <footer>
            <p>‚ö†Ô∏è For personal use only. Respect copyright laws.</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>